@use "../../settings/typography" as t;
@use "outputters" as o;
@use "validators" as v;

// Takes a sizing from the $font-size map (m, xl, xxl, etc) and convert it to
// the base unit. Alternatively convert a px font-size into the base unit.
//
// @param number|string $size
//   A size from the $font-size map or px value to be converted
// @param number|string $context
//   (optional) Only used if em is the $base-unit. The value of the parent
//   font-size if it differs from $base-font-size. Specified as a t-shirt size or
//   value in px.
//
// @return number
//   The selected font-size in $base-unit.
@function font-size($size, $context: t.$base-font-size) {
  $allowed-types: "font-size", "px";
  $type: v.typey-validator($size, $allowed-types);
  @if $type == "font-size" {
    @return o.output-from-font-size-map($size, $context);
  }
  @if $type == "px" {
    @return o.output-from-px($size, $context);
  }
}

// Generate a value to be used as line-height from either:
//   a) a multiple of $base-line-height
//   b) a static px value
//   c) a ratio of the font-size
//
// Example usage with multiple:
//   line-height: line-height(2);
// Example usage with static value:
//   line-height: line-height(18px);
// Example usage with ratio:
//   line-height: line-height(1.5);
//
// @param number $x
//   Multiple of $base-line-height to be used, px value to be converted, or ratio of
//   font-size.
// @param number|string $context
//   (optional) Only used if em is the $base-unit. The value of the
//   elements/parents font-size if it differs from $base-font-size.
//   Specified as a t-shirt size or value in px.
// @return number
//   The calculated height in $base-unit.
@function line-height($x, $context: t.$base-font-size) {
  $allowed-types: "multiplier", "px";
  $type: v.typey-validator($x, $allowed-types);
  @if $type == "multiplier" {
    @if (t.$line-height-method == "ratio") {
      @return o.output-from-ratio($x);
    } @else {
      @return o.output-from-multiplier($x, $context);
    }
  }
  @if $type == "px" {
    @return o.output-from-px($x, $context);
  }
}

// Generate a value to be used as some form of height or spacing from either:
//   a) a multiple of $base-line-height
//   b) a static px value
//
// Example usage with multiple:
//   height: spacing(2);
// Example usage with static value:
//   margin-bottom: spacing(18px);
//
// @param number $x
//   Multiple of $base-line-height to be used or px value to be converted.
// @param number|string $context
//   (optional) Only used if em is the $base-unit. The value of the elements/parents
//   font-size if it differs from $base-font-size. Specified as a t-shirt size or
//   value in px.
//
// @return number
//   The calculated spacing in $base-unit.
@function spacing($x, $context: t.$base-font-size) {
  $allowed-types: "multiplier", "px", "auto";
  $type: v.typey-validator($x, $allowed-types);
  @if $type == "multiplier" {
    @return o.output-from-multiplier($x, $context);
  }
  @if $type == "px" {
    @return o.output-from-px($x, $context);
  }
  @if $type == "auto" {
    @return auto;
  }
}
